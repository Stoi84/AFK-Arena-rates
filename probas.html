<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>Probabilités</title>
		
		<script>
			function factorial(n) {
				return n == 0 ? 1 : n * factorial(n-1);
			}
			
			function binomialDistribution(x, P, n) {
				return (factorial(n) / (factorial(n-x) * factorial(x))) * Math.pow(P, x) * Math.pow(1 - P, n-x);
			}
		</script>
		<script src="https://code.jquery.com/jquery-3.4.0.min.js"></script>
		
		<style>
			body {
				background: #464e5b;
				color: #eee;
				font-family: Verdana;
			}
			
			table {
				border-collapse: collapse;
				margin: 0 10px 10px 0;
				float: left;
				width: 300px;
			}
			
			thead {
				background: #eee;
			}
			
			thead > tr > td {
				color: #464e5b;
				text-align:center;
				font-weight: bold;
			}
			
			td {
				border: 1px solid;
				padding: 5px;
			}
		</style>
	</head>
	
	<body>
		<div>
			<div id="retour"></div>
		</div>
		<script>
			var P = 0.0461;
			var n = 10;
			var results = new Array(20);
			
			for(var i = 0; i < 15; ++i) {
				results[i] = (typeof results[i] != 'undefined' && results[i] instanceof Array) ? results[i] : []
				for(var j = 0; j < 20; ++j) {
					results[i][j] = j < n * (i+1) ? binomialDistribution(j+1, P, n * (i+1)) : 0;
				}
			}
		
			var resultsBkp = JSON.parse(JSON.stringify(results));
			var probabilities = new Array(20);
			const reducer = (accumulator, currentValue) => accumulator + currentValue;
			
			results.forEach(function(v, i) {
				for(var j = 0; j < 20; ++j) {
					probabilities[j] = (typeof probabilities[j] != 'undefined' && probabilities[j] instanceof Array) ? probabilities[j] : []
					var arr = j > 0 ? JSON.parse(JSON.stringify(v)).slice(0,j) : [0];
					probabilities[j][i] = (1 - Math.pow(1-P, (i+1) * n)) - arr.reduce(reducer);
				}
			});
			
			probabilities.forEach(function(v, i) {
				var table = $('<table class="array">');
				var thead = $('<thead><tr><td>Nb tirages</td><td>' + (i+1) + ' élite(s) ou plus</td></tr></thead>');
				thead.appendTo(table);
				
				v.forEach(function(w, i) {
					$('<tr><td>' + (i+1) + '</td><td>' + (w*100).toFixed(12) + '%</tr>').appendTo(table);
				});
				table.appendTo('body')
			});
		</script>
	</body>
</html>